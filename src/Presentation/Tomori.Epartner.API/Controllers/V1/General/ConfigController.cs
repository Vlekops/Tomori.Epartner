//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated from a template.
// </auto-generated>
//------------------------------------------------------------------------------

using Microsoft.AspNetCore.Mvc;
using Vleko.Result;
using Tomori.Epartner.Core.Config.Query;
using Tomori.Epartner.Core.Request;
using Tomori.Epartner.Core.Config.Command;
using Microsoft.AspNetCore.Authorization;
using Tomori.Epartner.Core.Attributes;

namespace Tomori.Epartner.API.Controllers
{
    public partial class ConfigController : BaseController<ConfigController>
    {
        [HttpGet(template: "email")]
        public async Task<IActionResult> GetEmail()
        {
            return Wrapper(await _mediator.Send(new GetEmailConfigRequest()));
        }
        [HttpGet(template: "company")]
        public async Task<IActionResult> GetCompany()
        {
            return Wrapper(await _mediator.Send(new GetCompanyConfigRequest()));
        }
        [HttpGet(template: "setting")]
        public async Task<IActionResult> GetSetting()
        {
            return Wrapper(await _mediator.Send(new GetSettingConfigRequest()));
        }
        [HttpGet(template: "integration")]
        public async Task<IActionResult> GetIntegration()
        {
            return Wrapper(await _mediator.Send(new GetIntegrationConfigRequest()));
        }

        [HttpGet(template: "list")]
        public async Task<IActionResult> List(ConfigCategory? category, int? start, int? length)
        {
            return Wrapper(await _mediator.Send(new GetConfigListRequest()
            {
                Category = category,
                Length = length,
                Start = start
            }), new
            {
                Category = category,
                Length = length,
                Start = start
            });
        }

        [HttpPost(template: "save_company")]
        public async Task<IActionResult> SaveCompany([FromBody] CompanyConfig request)
        {
            var save_request = _mapper.Map<SaveConfigCompanyRequest>(request);
            save_request.Token = Token.User;
            return Wrapper(await _mediator.Send(save_request), request);
        }
        [HttpPost(template: "save_setting")]
        public async Task<IActionResult> SaveSetting([FromBody] SettingConfig request)
        {
            var save_request = _mapper.Map<SaveConfigSettingRequest>(request);
            save_request.Token = Token.User;
            return Wrapper(await _mediator.Send(save_request), request);
        }
        [HttpPost(template: "save_email")]
        public async Task<IActionResult> SaveEmail([FromBody] EmailConfig request)
        {
            var save_request = _mapper.Map<SaveConfigMailRequest>(request);
            save_request.Token = Token.User;
            return Wrapper(await _mediator.Send(save_request), request);
        }
        [HttpPost(template: "save_integration")]
        public async Task<IActionResult> SaveIntegration([FromBody] IntegrationConfig request)
        {
            var save_request = _mapper.Map<SaveConfigIntegrationRequest>(request);
            save_request.Token = Token.User;
            return Wrapper(await _mediator.Send(save_request), request);
        }

        [HttpGet(template: "counter/{modul}")]
        public async Task<IActionResult> GetCounter(string modul, string prefix)
        {
            return Wrapper(await _mediator.Send(new GetCounterTransactionRequest() { Modul = modul, Prefix = prefix }));
        }
    }
}

